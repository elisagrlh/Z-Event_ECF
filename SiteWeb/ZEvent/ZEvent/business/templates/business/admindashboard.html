{% extends "business/base.html" %}

{% block content %}

<div id="app">
    <!-- Section de création de compte Streamer -->
    <div class="content">
        
        <div class="buttons-group">

            <button @click="currentTab = 'streamerCreation'">Créer un compte Streamer</button>
            <button @click="currentTab = 'materialList'">Liste de matériel demandé</button>
            <button @click="currentTab = 'streamerCount'">Nombre de Streamers présents</button>
        </div>




        <!--<h2>Créer un compte Streamer</h2>
        <form id="streamerForm">
            <input type="text" id="streamerName" placeholder="Nom du Streamer" required>
            <button type="submit">Créer</button>
        </form>-->
        <div v-show="currentTab === 'streamerCreation'">
            <form class="streamerCreationForm" method="POST">
                {% csrf_token %}
                {{ form.as_p }}
                {{ ageForm.as_p }}
                <button type="submit">Créer l'utilisateur</button>
                {% if messages %}
                    <ul class="messages">
                        {% for message in messages %}
                        <p {% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}<p>
                        {% endfor %}
                    </ul>
                {% endif %}

            </form>
        </div>  

    </div>

    <!-- Section de la liste de matériel -->

    <div class="content" v-show="currentTab === 'materialList'">
        <ul id="materialList">
            <!-- Les éléments de la liste seront injectés ici par JavaScript -->
            pouet
        </ul>
    </div>

    <!-- Section du nombre de Streamers présents -->

    <div class="content" v-show="currentTab === 'streamerCount'">
        <p id="streamersCount">Chargement...</p>
    </div>
    
</div>
{% endblock %}

{% verbatim %}
<!-- 
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function() {
    // Fetch initial data
    fetchMaterialList();
    fetchStreamersCount();

    // Handle form submission for new streamer
    $('#streamerForm').submit(function(e) {
        e.preventDefault();
        var streamerName = $('#streamerName').val();
        $.ajax({
            url: '{% url "login" %}',
            type: 'post',
            data: {
                name: streamerName,
                // Include other data as necessary
                csrfmiddlewaretoken: '{{ csrf_token }}'
            },
            success: function() {
                // Reset form, fetch updated data
                $('#streamerName').val('');
                fetchMaterialList();
                fetchStreamersCount();
            }
        });
    });
});

function fetchMaterialList() {
    $.ajax({
        url: '{% url "login" %}',
        type: 'get',
        success: function(data) {
            var listItems = '';
            $.each(data, function(i, item) {
                listItems += '<li>' + item.name + ': ' + item.quantity + ' nécessaire(s)</li>';
            });
            $('#materialList').html(listItems);
        }
    });
}

function fetchStreamersCount() {
    $.ajax({
        url: '{% url "login" %}',
        type: 'get',
        success: function(count) {
            $('#streamersCount').text('Il y a actuellement ' + count + ' streamer(s) à l\'événement.');
        }
    });
}
</script>
-->
{% endverbatim %}
